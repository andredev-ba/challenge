import{u as E}from"./breadcrumb-store.51dbc2c4.js";import{d as C,u as Q,a as B,r as N,c as q,o as L,e as p,f,w as r,g as t,h as g,Q as i,i as R,j as $,l as S,m as V,p as x,t as m,n as _,q as I,s as T}from"./index.e5ec3fee.js";import{Q as D}from"./QImg.db652b52.js";import{Q as b,a as j}from"./QTable.dbb6c7a0.js";import{P as h}from"./ProductService.49521e52.js";import{u as z}from"./use-quasar.2a01554d.js";import"./QList.138cbcc7.js";import"./QSelect.5c5caa48.js";import"./format.53708e68.js";import"./axios.e1b98896.js";const A={class:"q-pa-sm"},K={class:"text-center"},F=C({__name:"ListComponent",setup(P){Q(),B();const n=z(),c=N(null),a=q({tableLoading:!1,tableRows:[],pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:20,rowsNumber:100,from:1,to:1},filters:{search:""}}),y=[{name:"image_url",label:"Imagem",align:"center",field:"image_url",sortable:!0,style:"width: 10%"},{name:"name",label:"Produto",align:"left",field:"name",sortable:!0,style:"width: 20%; white-space: pre-line;"},{name:"description",label:"Descri\xE7\xE3o",align:"left",field:"description",sortable:!0,style:"width: 30%; white-space: pre-line;"},{name:"price",label:"Pre\xE7o",align:"left",field:"price",sortable:!0,style:"width: 10%"},{name:"expiration_date",label:"Data de validade",align:"left",field:"expiration_date",sortable:!0,style:"width: 10%"},{name:"category",label:"Categoria",align:"left",field:"category",sortable:!1,style:"width: 10%"},{name:"actions",label:"A\xE7\xE3o",align:"center",field:"actions",style:"width: 10%"}];L(()=>{d()});function d(){c.value.requestServerInteraction()}async function k(s){a.tableLoading=!0;const{page:o,rowsPerPage:e,sortBy:l,descending:w}=s.pagination,{data:u}=await h.getProducts({page:o,sortBy:l,descending:w,rowsPerPage:e,...a.filters});a.tableRows=u.items,a.pagination={sortBy:l,descending:w,page:o,rowsPerPage:e,rowsNumber:u.total,from:u.from,to:u.to},a.tableLoading=!1}async function v(s,o){n.dialog({title:"Confirma\xE7\xE3o de exclus\xE3o",message:`Tem certeza de que deseja excluir o produto ${o}?`,ok:{label:"Sim",push:!0,color:"positive"},cancel:{label:"Cancelar",color:"negative"}}).onOk(async()=>{(await h.deleteProduct(s)).status==200?(n.notify({type:"positive",message:"Produto exclu\xEDda com sucesso!"}),d()):(n.dialog({title:"Erro na Solicita\xE7\xE3o",message:"Ocorreu um erro ao excluir o produto. Por favor, tente novamente.",color:"negative",persistent:!0}),d())})}return(s,o)=>(p(),f(I,{class:"q-pa-sm"},{default:r(()=>[t(V,{class:"justify-between"},{default:r(()=>[g("div",null,[t(i,{"no-caps":"",icon:"fa-solid fa-plus-circle",color:"primary",label:"Adicionar",onClick:o[0]||(o[0]=e=>s.$router.push("/produtos/adicionar"))})]),g("div",null,[t(R,{onKeyup:$(d,["enter"]),modelValue:a.filters.search,"onUpdate:modelValue":o[1]||(o[1]=e=>a.filters.search=e),outlined:"",dense:"",placeholder:"Pesquisa",style:{width:"600px"}},{append:r(()=>[t(S,{onClick:d,style:{cursor:"pointer"},name:"search"})]),_:1},8,["onKeyup","modelValue"])])]),_:1}),g("div",A,[t(j,{class:"table-striped col-12",flat:"",bordered:"",ref_key:"tableRef",ref:c,rows:a.tableRows,columns:y,"row-key":"id",separator:"cell",pagination:a.pagination,"onUpdate:pagination":o[2]||(o[2]=e=>a.pagination=e),"binary-state-sort":"",onRequest:k,"rows-per-page-options":[5,20,50,100],"no-data-label":"Nenhum registro encontrado","loading-label":"Buscando dados...","rows-per-page-label":"Registros por p\xE1gina",loading:a.tableLoading},{"body-cell-image_url":r(e=>[t(b,{props:e},{default:r(()=>[g("div",K,[t(D,{style:{width:"50px",heigth:"50px"},src:e.row.image_url},null,8,["src"])])]),_:2},1032,["props"])]),"body-cell-category":r(e=>[t(b,{props:e},{default:r(()=>{var l;return[x(m(((l=e.row.category)==null?void 0:l.name)||"Sem categoria"),1)]}),_:2},1032,["props"])]),"body-cell-actions":r(e=>[t(b,{props:e},{default:r(()=>[t(i,{size:"sm",padding:"xs",color:"blue",round:"",dense:"",icon:"edit",title:"Editar",onClick:l=>s.$router.push(`/produtos/editar/${e.row.id}`)},null,8,["onClick"]),t(i,{size:"sm",padding:"xs",color:"red",round:"",dense:"",icon:"delete",class:"q-ml-sm",title:"Excluir",onClick:l=>v(e.row.id,e.row.name)},null,8,["onClick"])]),_:2},1032,["props"])]),pagination:r(e=>[e.pagesNumber>2?(p(),f(i,{key:0,icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.firstPage},null,8,["disable","onClick"])):_("",!0),t(i,{icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.prevPage},null,8,["disable","onClick"]),t(i,{icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.nextPage},null,8,["disable","onClick"]),e.pagesNumber>2?(p(),f(i,{key:1,icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.lastPage},null,8,["disable","onClick"])):_("",!0),x(" "+m(a.pagination.from)+" - "+m(a.pagination.to)+" de "+m(a.pagination.rowsNumber),1)]),_:1},8,["rows","pagination","loading"])])]),_:1}))}}),ee=C({__name:"ListPage",setup(P){const n=E(),{setBreadcrumbs:c}=n;return T(()=>{c([{text:"Produtos",link:"/produtos"},{text:"Lista"}])}),(a,y)=>(p(),f(F))}});export{ee as default};
